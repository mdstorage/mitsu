{% extends 'CatalogCommonBundle:Catalog:05_subgroups.html.twig' %}
{% use 'CatalogAudiBundle::audi.base.html.twig' %}
{% block breadcrumbs %}
    <a href="{{ path('catalog_audi') }}">Регион, модель, модификация ({{ oContainer.getActiveRegion.getRuname }}, 
   {{ oContainer.getActiveModel.getRuname }}, {{ oContainer.getActiveModification.getRuname }})</a> /
    <a href="{{ path('catalog_audi_groups', parameters) }}">Группа запчастей ({{ oContainer.getActiveGroup.getRuname}})</a> / 
    Подгруппа запчастей
{% endblock breadcrumbs %}
{% block complectation %}
{% endblock complectation %}

{% block subgroupImage %}{% endblock subgroupImage %}

 {% block subGroupsMap %}


{% block subgroupItem %}

    <div class="row">


        <div class="form-group">

            <div class="col-lg-5">

                <input name="filter-query" class="form-control" value="" id="filter-query" onclick="this.value='';"
                       type="text" placeholder="Введите любой признак для фильтрации параметров"/>
            </div>

            <a href="#" class="btn btn-default" onclick="$('#filter-query').val('');
        repeatact();return false">Показать все</a>

        </div>


    </div>

   <div class="row">
        {% if oContainer.getActiveGroup.getSubgroups|first.getOption('ObDvig') %}

                <b>Двигатель:</b>
                {% for trans in oContainer.getActiveGroup.getSubgroups|first.getOption('ObDvig') %}

                    <a href="#" class="btn btn-default" onclick="$('#filter-query').val('{{ trans }}');
                                                       repeatact();return false">{{ trans }}</a>

                {% endfor %}

        {% endif %}


    </div><hr />
    <br/>





              <table class="table">
                  <thead>
                  <tr>
                      <th>Подгруппа</th>
                      <th>Код</th>
                      <th>Описание</th>
                      <th>Примечание</th>
                      <th>Данные по модели</th>
                      <th>Изображение</th>

                  </tr>
                  </thead>
                  <tbody>
                  {% for subgroup in oContainer.getActiveGroup.getSubgroups %}

                      <tr id="tri">
                                                  <td>{{ subgroup.getOption('podgr') }}</td>
                                                  <td>{{ subgroup.getCode }}</td>
                                                  <td> <a href="{{ path('catalog_audi_schemas', parameters|merge({'subGroupCode': subgroup.getCode})) }}"> {{ subgroup.getRuname }}</a></td>
                          <td>{{ subgroup.getOption('prime4') }}</td>
               <td>{{ subgroup.getOption('dannye')|replace({';':' '}) }}</td>
                <td>
                <div class="row">
                    <a href="{{ path('catalog_audi_schemas', parameters|merge({'subGroupCode': subgroup.getCode})) }}">
                    <img src="{{ asset('bundles/catalogaudi/Images/Minis/'~subgroup.getOption('grafik')~'.png') }}" width="100" alt="{{ subgroup.getRuname }}"/>
                    </a>
                </div>
                </td>
            </tr>

        {% endfor %}
        </tbody>
    </table>

<script>

$(document).ready(function() {

  $('#filter-query').keyup(function(event){

      if (event.keyCode == 27 || $(this).val() == '') {
          $(this).val('');
          $('.table tbody tr').removeClass('visible').show().addClass('visible');
      }
      else {
          filter('.table tbody tr', $(this).val());
      }
  });

});
function filter(selector, query) {
  query = $.trim(query);
  $(selector).each(function() {
      ($(this).text().search(new RegExp(query, "i")) < 0)
              ? $(this).hide().removeClass('visible') : $(this).show().addClass('visible');
  });
}
function repeatact(){
  filter('.table tbody tr', $('#filter-query').val());
}

</script>
{% endblock subgroupItem %}
{% endblock subGroupsMap %}